(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(e,t,n){e.exports=n.p+"static/media/shopping-cart-solid.701d6d1d.svg"},33:function(e,t,n){e.exports=n.p+"static/media/food-bg.698e5e80.jpg"},34:function(e,t,n){e.exports=n(52)},39:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),i=n.n(c),o=n(10),s=n(14),u=n(16),l=n(15),m=n(17),d=n(11),p=(n(39),function(e){var t=e.menuItem,n=e.onAddToCart,a=t.title,c=t.price,i=t.url,o=t.category;return r.a.createElement("li",{className:"menu__item"},r.a.createElement(d.b,{to:"/".concat(t.id)},r.a.createElement("div",{className:"menu__title"},a),r.a.createElement("img",{className:"menu__img",src:i,alt:a}),r.a.createElement("div",{className:"menu__category"},"Category: ",r.a.createElement("span",null,o)),r.a.createElement("div",{className:"menu__price"},"Price: ",r.a.createElement("span",null,c,"$"))),r.a.createElement("button",{onClick:function(){return n()},className:"menu__btn"},"Add to cart"),r.a.createElement("span",{className:"menu__category_Img ".concat(o)}))}),f=n(5),E=r.a.createContext(),_=function(){return function(e){return function(t){return r.a.createElement(E.Consumer,null,function(n){return r.a.createElement(e,Object.assign({},t,{RestoService:n}))})}}},b=function(e){return{type:"MENU_LOADED",payload:e}},v=function(){return{type:"MENU_REQUESTED"}},h=function(){return{type:"MENU_REJECTED"}},O=function(e){return{type:"ITEM_ADD_TO_CART",payload:e}},g=function(e,t){return{type:"ITEM_CHANGE_COUNT",payload:t,event:e}},j=function(){return r.a.createElement("div",{className:"spinner"},"loading...")},y=(n(46),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.menuRequested(),this.props.RestoService.getMenuItems().then(function(t){return e.props.menuLoaded(t)}).catch(function(e){return console.log(" ".concat(e,", status: ").concat(e.status))})}},{key:"render",value:function(){var e=this.props,t=e.menuItems,n=e.loading,a=e.addedToCart;if(n)return r.a.createElement(j,null);var c=t.map(function(e){return r.a.createElement(p,{key:e.id,menuItem:e,onAddToCart:function(){return a(e.id)}})});return r.a.createElement(C,{items:c})}}]),t}(a.Component)),N={menuLoaded:b,menuRequested:v,menuRejected:h,addedToCart:O,changeCount:g},C=function(e){var t=e.items;return r.a.createElement("ul",{className:"menu__list"},t)},k=_()(Object(f.b)(function(e){return{menuItems:e.menu,loading:e.loading,error:e.error}},N)(y)),R=function(){return r.a.createElement(k,null)},T=(n(47),function(e){return e.map(function(e){return{id:e.id,qtty:e.qtty}})}),x={delFromCart:function(e){return{type:"ITEM_REMOVE_FROM_CART",payload:e}},changeCount:g},I=_()(Object(f.b)(function(e){return{items:e.items,totalPrice:e.totalPrice}},x)(function(e){var t=e.items,n=e.delFromCart,a=e.changeCount,c=e.totalPrice,i=e.RestoService;return 0===t.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"cart__title"},"Your basket is empty"),r.a.createElement("div",{className:"cart__message"},"Rather, order something delicious!")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"cart__title"},"Your order:"),r.a.createElement("div",{className:"cart__list"},t.map(function(e){var t=e.title,c=e.price,i=e.url,o=e.id,s=e.qtty;return r.a.createElement("div",{key:o,className:"cart__item"},r.a.createElement("img",{src:i,className:"cart__item-img",alt:t}),r.a.createElement("div",{className:"cart__item-title"},t),r.a.createElement("div",{className:"cart__item-price"},c,"$"),r.a.createElement("div",{className:"food-counter"},r.a.createElement("button",{className:"counter-button counter-minus",onClick:function(e){return a(e,o)}},"-"),r.a.createElement("span",{className:"counter"},s),r.a.createElement("button",{className:"counter-button counter-plus",onClick:function(e){return a(e,o)}},"+")),r.a.createElement("div",{onClick:function(){return n(o)},className:"cart__close"},"\xd7"))}),r.a.createElement("div",{className:"cart__order_box"},r.a.createElement("div",{className:"cart__order_box-title"},"Total: "),r.a.createElement("div",{className:"cart__order_box-total"},c,"$"),r.a.createElement("button",{onClick:function(){i.setOrder(T(t))},className:"cart__order_box-btn"},"Proceed to checkout"))))})),P=function(){return r.a.createElement("div",{className:"cart"},r.a.createElement(I,null))},M=(n(48),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;0===this.props.menuItems.length&&(this.props.menuRequested(),this.props.RestoService.getMenuItems().then(function(t){return e.props.menuLoaded(t)}).catch(function(t){return e.props.menuRejected()}))}},{key:"render",value:function(){var e=this;if(this.props.loading)return r.a.createElement("div",{className:"item_page"},r.a.createElement(j,null));var t=this.props.menuItems.find(function(t){return+t.id===+e.props.match.params.id}),n=t.title,a=t.url,c=t.category,i=t.price,o=t.id;return r.a.createElement("div",{className:"item_page"},r.a.createElement("div",{className:"menu__item item_block"},r.a.createElement("div",{className:"menu__title"},n),r.a.createElement("img",{className:"menu__img",src:a,alt:n}),r.a.createElement("div",{className:"menu__category"},"Category: ",r.a.createElement("span",null,c)),r.a.createElement("div",{className:"menu__price"},"Price: ",r.a.createElement("span",null,i,"$")),r.a.createElement("button",{onClick:function(){return e.props.addedToCart(o)},className:"menu__btn"},"Add to cart"),r.a.createElement("span",{className:"menu__category_Img ".concat(c)})))}}]),t}(a.Component)),w={menuLoaded:b,menuRequested:v,menuRejected:h,addedToCart:O},q=_()(Object(f.b)(function(e){return{menuItems:e.menu,loading:e.loading,error:e.error}},w)(M)),D=n(32),A=n.n(D),S=(n(49),Object(f.b)(function(e){return{totalPrice:e.totalPrice}})(function(e){var t=e.totalPrice;return r.a.createElement("header",{className:"header"},r.a.createElement(d.b,{to:"/simple-restaurant-app/",className:"header__link"},"Menu"),r.a.createElement(d.b,{to:"/simple-restaurant-app/cart",className:"header__link"},r.a.createElement("img",{className:"header__cart",src:A.a,alt:"cart"}),"Total: ",t," $"))})),U=n(33),L=n.n(U),J=n(1),F=function(){return r.a.createElement("div",{style:{background:"url(".concat(L.a,") center center/cover no-repeat")},className:"app"},r.a.createElement(S,null),r.a.createElement(J.c,null,r.a.createElement(J.a,{path:"/simple-restaurant-app/",exact:!0,component:R}),r.a.createElement(J.a,{path:"/simple-restaurant-app/cart",component:P}),r.a.createElement(J.a,{path:"/simple-restaurant-app/:id",component:q})))},B=function(){return r.a.createElement("div",{className:"error"},"Error")},$=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(){this.props.menuRejected()}},{key:"render",value:function(){return this.props.error?r.a.createElement(B,null):this.props.children}}]),t}(a.Component),G={menuRejected:h},H=Object(f.b)(function(e){return{menuItems:e.menu,loading:e.loading,error:e.error}},G)($),Q=n(9),V=n.n(Q),Y=n(19),z=n(21),K=n(7),W=n(4),X={menu:[],items:[],totalPrice:0,loading:!0,error:!1},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MENU_LOADED":return Object(W.a)({},e,{menu:t.payload,loading:!1});case"MENU_REQUESTED":return Object(W.a)({},e,{loading:!0});case"MENU_REJECTED":return Object(W.a)({},e,{error:!0});case"ITEM_ADD_TO_CART":var n=t.payload,a=e.items.findIndex(function(e){return e.id===n});if(a>=0){var r=e.items.find(function(e){return e.id===n}),c=Object(W.a)({},r,{qtty:++r.qtty});return Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items.slice(0,a)),[c],Object(K.a)(e.items.slice(a+1))),totalPrice:e.totalPrice+c.price})}var i=e.menu.find(function(e){return e.id===n}),o={title:i.title,price:i.price,url:i.url,id:i.id,qtty:1};return Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items),[o]),totalPrice:e.totalPrice+o.price});case"ITEM_REMOVE_FROM_CART":var s=t.payload,u=e.items.findIndex(function(e){return e.id===s}),l=e.items[u].price*e.items[u].qtty;return Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items.slice(0,u)),Object(K.a)(e.items.slice(u+1))),totalPrice:e.totalPrice-l});case"ITEM_CHANGE_COUNT":var m=t.event.target,d=t.payload;if(m.classList.contains("counter-button")){var p=e.items.find(function(e){return e.id===d}),f=e.items.findIndex(function(e){return e.id===d}),E=e.items[f].price*e.items[f].qtty;if(m.classList.contains("counter-minus")){var _=Object(W.a)({},p,{qtty:--p.qtty});return 0===_.qtty?Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items.slice(0,f)),Object(K.a)(e.items.slice(f+1))),totalPrice:e.totalPrice-E}):Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items.slice(0,f)),[_],Object(K.a)(e.items.slice(f+1))),totalPrice:e.totalPrice-_.price})}if(m.classList.contains("counter-plus")){var b=Object(W.a)({},p,{qtty:++p.qtty});return Object(W.a)({},e,{items:[].concat(Object(K.a)(e.items.slice(0,f)),[b],Object(K.a)(e.items.slice(f+1))),totalPrice:e.totalPrice+b.price})}}return e;default:return e}},ee=Object(z.b)(Z),te=(n(51),new function e(){var t=this;Object(o.a)(this,e),this.getResource=function(){var e=Object(Y.a)(V.a.mark(function e(n){var a;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._dataBase).concat(n));case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(n,", status: ").concat(a.status));case 5:return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getMenuItems=Object(Y.a)(V.a.mark(function e(){return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/menu/");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.setOrder=function(){var e=Object(Y.a)(V.a.mark(function e(n){var a,r,c;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getOrderNum();case 2:return a=e.sent,r={id:a,order:n},e.next=6,fetch("".concat(t._dataBase,"/orders"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r)});case 6:if((c=e.sent).ok){e.next=9;break}throw new Error("failed to response JSON DB");case 9:console.log("status: ".concat(c.status,", data: ").concat(JSON.stringify(r)));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getOrderNum=Object(Y.a)(V.a.mark(function e(){var n;return V.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/orders/");case 2:return n=e.sent,e.abrupt("return",++n.length);case 4:case"end":return e.stop()}},e)})),this._dataBase="https://my-json-server.typicode.com/IlyaErshovDev/resto-db"});i.a.render(r.a.createElement(f.a,{store:ee},r.a.createElement(H,null,r.a.createElement(E.Provider,{value:te},r.a.createElement(d.a,null,r.a.createElement(F,null))))),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.c6484326.chunk.js.map